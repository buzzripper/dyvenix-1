import{a as $}from"./chunk-HAH7XBVJ.js";import{$ as Z,Ba as X,E as J,Ia as ee,J as W,Kb as oe,S as Y,Uc as j,V as U,Y as O,Yb as le,ca as y,da as q,db as te,f as K,fa as f,g as B,ha as p,ia as g,k as G,kb as F,l as M,la as L,m as w,mb as ne,nb as ie,r as T,s as z,sa as Q,wb as se,x as N,xb as re,yb as ae}from"./chunk-Q34RPHHW.js";import{a as h,b as A,d as H}from"./chunk-WWX6BADO.js";var E=class{translations;constructor(a){this.translations=a}getTranslation(a){return w(this.translations.get(a)||{})}},he=new f("TRANSLOCO_LOADER");function I(t,a){return t&&(Object.prototype.hasOwnProperty.call(t,a)?t[a]:a.split(".").reduce((e,n)=>e?.[n],t))}function Ae(t,a,e){t=h({},t);let n=a.split("."),i=n.length-1;return n.reduce((s,r,o)=>(o===i?s[r]=e:s[r]=Array.isArray(s[r])?s[r].slice():h({},s[r]),s&&s[r]),t),t}function de(t){return t?Array.isArray(t)?t.length:R(t)?Object.keys(t).length:t?t.length:0:0}function Oe(t){return de(t)===0}function Ce(t){return typeof t=="function"}function b(t){return typeof t=="string"}function R(t){return!!t&&typeof t=="object"&&!Array.isArray(t)}function fe(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,(a,e)=>e==0?a.toLowerCase():a.toUpperCase()).replace(/\s+|_|-|\//g,"")}function _(t){return t==null}function ce(t){return _(t)===!1}function ge(t){return t&&typeof t.scope=="string"}function we(t){return t&&R(t.loader)}function ue(t){let a={};function e(n,i){if(n===null)a[i]=null;else if(R(n))for(let[s,r]of Object.entries(n))e(r,i?`${i}.${s}`:s);else a[i]=n}return e(t,""),a}function Re(t){let a={};for(let[e,n]of Object.entries(t)){let i=e.split("."),s=a;i.forEach((r,o)=>{o===i.length-1?s[r]=n:(s[r]??={},s=s[r])})}return a}var S=new f("TRANSLOCO_CONFIG",{providedIn:"root",factory:()=>m}),m={defaultLang:"en",reRenderOnLangChange:!1,prodMode:!1,failedRetries:2,fallbackLang:[],availableLangs:[],missingHandler:{logMissingKey:!0,useFallbackTranslation:!1,allowEmpty:!1},flatten:{aot:!1},interpolation:["{{","}}"],scopes:{keepCasing:!1}};function Me(t={}){return A(h(h({},m),t),{missingHandler:h(h({},m.missingHandler),t.missingHandler),flatten:h(h({},m.flatten),t.flatten),scopes:h(h({},m.scopes),t.scopes)})}var pe=new f("TRANSLOCO_TRANSPILER"),Ne=(()=>{class t{config=g(S,{optional:!0})??m;get interpolationMatcher(){return Fe(this.config)}transpile({value:e,params:n={},translation:i,key:s}){if(b(e)){let r,o=e;for(;(r=this.interpolationMatcher.exec(o))!==null;){let[c,l]=r;o=o.replace(c,()=>{let u=l.trim(),d=I(n,u);return ce(d)?d:ce(i[u])?this.transpile({params:n,translation:i,key:s,value:i[u]}):""})}return o}else n&&(R(e)?e=this.handleObject({value:e,params:n,translation:i,key:s}):Array.isArray(e)&&(e=this.handleArray({value:e,params:n,translation:i,key:s})));return e}handleObject({value:e,params:n={},translation:i,key:s}){let r=e;return Object.keys(n).forEach(o=>{let c=this.transpile({value:I(r,o),params:I(n,o),translation:i,key:s});r=Ae(r,o,c)}),r}handleArray(i){var s=i,{value:e}=s,n=H(s,["value"]);return e.map(r=>this.transpile(h({value:r},n)))}static \u0275fac=function(n){return new(n||t)};static \u0275prov=y({token:t,factory:t.\u0275fac})}return t})();function Fe(t){let[a,e]=t.interpolation;return new RegExp(`${a}([^${a}${e}]*?)${e}`,"g")}var ve=new f("TRANSLOCO_MISSING_HANDLER"),je=(()=>{class t{handle(e,n){if(n.missingHandler.logMissingKey&&!n.prodMode){let i=`Missing translation for '${e}'`;console.warn(`%c ${i}`,"font-size: 12px; color: red")}return e}static \u0275fac=function(n){return new(n||t)};static \u0275prov=y({token:t,factory:t.\u0275fac})}return t})(),Le=new f("TRANSLOCO_INTERCEPTOR"),$e=(()=>{class t{preSaveTranslation(e){return e}preSaveTranslationKey(e,n){return n}static \u0275fac=function(n){return new(n||t)};static \u0275prov=y({token:t,factory:t.\u0275fac})}return t})(),Te=new f("TRANSLOCO_FALLBACK_STRATEGY"),Ie=(()=>{class t{userConfig;constructor(e){this.userConfig=e}getNextLangs(){let e=this.userConfig.fallbackLang;if(!e)throw new Error("When using the default fallback, a fallback language must be provided in the config!");return Array.isArray(e)?e:[e]}static \u0275fac=function(n){return new(n||t)(p(S))};static \u0275prov=y({token:t,factory:t.\u0275fac})}return t})();function C(t){if(!t)return"";let a=t.split("/");return a.pop(),a.join("/")}function v(t){return t?t.split("/").pop():""}function x(t,a,e="|"){if(b(t)){let n=t.split(e),i=n.pop();return i===a?[!0,n.toString()]:[!1,i]}return[!1,""]}function De(t,a){let[e]=x(a,"static");return e?!1:!!t.config.reRenderOnLangChange}function Ee(t){return t?a=>a:W(1)}function _e(t,a){return Object.keys(t).reduce((e,n)=>(e[`${a}/${n}`]=t[n],e),{})}function ye(t,a){return we(t)?_e(t.loader,a):void 0}function D(t){return{scope:C(t)||null,langName:v(t)}}function me(t){let{path:a,inlineLoader:e,mainLoader:n,data:i}=t;if(e){let s=e[a];if(Ce(s)===!1)throw`You're using an inline loader but didn't provide a loader for ${a}`;return e[a]().then(r=>r.default?r.default:r)}return n.getTranslation(a,i)}function xe({mainLoader:t,path:a,data:e,fallbackPath:n,inlineLoader:i}){return(n?[a,n]:[a]).map(r=>{let o=me({path:r,mainLoader:t,inlineLoader:i,data:e});return M(o).pipe(T(c=>({translation:c,lang:r})))})}var Pe;var ke=(()=>{class t{loader;parser;missingHandler;interceptor;fallbackStrategy;langChanges$;translations=new Map;cache=new Map;firstFallbackLang;defaultLang="";availableLangs=[];isResolvedMissingOnce=!1;lang;failedLangs=new Set;events=new K;events$=this.events.asObservable();config;constructor(e,n,i,s,r,o){this.loader=e,this.parser=n,this.missingHandler=i,this.interceptor=s,this.fallbackStrategy=o,this.loader||(this.loader=new E(this.translations)),Pe=this,this.config=JSON.parse(JSON.stringify(r)),this.setAvailableLangs(this.config.availableLangs||[]),this.setFallbackLangForMissingTranslation(this.config),this.setDefaultLang(this.config.defaultLang),this.lang=new B(this.getDefaultLang()),this.langChanges$=this.lang.asObservable(),this.events$.pipe($()).subscribe(c=>{c.type==="translationLoadSuccess"&&c.wasFailure&&this.setActiveLang(c.payload.langName)})}getDefaultLang(){return this.defaultLang}setDefaultLang(e){this.defaultLang=e}getActiveLang(){return this.lang.getValue()}setActiveLang(e){return this.parser.onLangChanged?.(e),this.lang.next(e),this.events.next({type:"langChanged",payload:D(e)}),this}setAvailableLangs(e){this.availableLangs=e}getAvailableLangs(){return this.availableLangs}load(e,n={}){let i=this.cache.get(e);if(i)return i;let s,r=this._isLangScoped(e),o;r&&(o=C(e));let c={path:e,mainLoader:this.loader,inlineLoader:n.inlineLoader,data:r?{scope:o}:void 0};if(this.useFallbackTranslation(e)){let u=r?`${o}/${this.firstFallbackLang}`:this.firstFallbackLang,d=xe(A(h({},c),{fallbackPath:u}));s=N(d)}else{let u=me(c);s=M(u)}let l=s.pipe(Y(this.config.failedRetries),Z(u=>{if(Array.isArray(u)){u.forEach(d=>{this.handleSuccess(d.lang,d.translation),d.lang!==e&&this.cache.set(d.lang,w({}))});return}this.handleSuccess(e,u)}),J(u=>(this.config.prodMode||console.error(`Error while trying to load "${e}"`,u),this.handleFailure(e,n))),U(1));return this.cache.set(e,l),l}translate(e,n={},i=this.getActiveLang()){if(!e)return e;let{scope:s,resolveLang:r}=this.resolveLangAndScope(i);if(Array.isArray(e))return e.map(l=>this.translate(s?`${s}.${l}`:l,n,r));e=s?`${s}.${e}`:e;let o=this.getTranslation(r),c=o[e];return c?this.parser.transpile({value:c,params:n,translation:o,key:e}):this._handleMissingKey(e,c,n)}selectTranslate(e,n,i,s=!1){let r,o=(l,u)=>this.load(l,u).pipe(T(()=>s?this.translateObject(e,n,l):this.translate(e,n,l)));if(_(i))return this.langChanges$.pipe(O(l=>o(l)));if(i=Array.isArray(i)?i[0]:i,ge(i)){let l=i;i=l.scope,r=ye(l,l.scope)}if(i=i,this.isLang(i)||this.isScopeWithLang(i))return o(i);let c=i;return this.langChanges$.pipe(O(l=>o(`${c}/${l}`,{inlineLoader:r})))}isScopeWithLang(e){return this.isLang(v(e))}translateObject(e,n={},i=this.getActiveLang()){if(b(e)||Array.isArray(e)){let{resolveLang:r,scope:o}=this.resolveLangAndScope(i);if(Array.isArray(e))return e.map(u=>this.translateObject(o?`${o}.${u}`:u,n,r));let c=this.getTranslation(r);e=o?`${o}.${e}`:e;let l=Re(this.getObjectByKey(c,e));return Oe(l)?this.translate(e,n,i):this.parser.transpile({value:l,params:n,translation:c,key:e})}let s=[];for(let[r,o]of this.getEntries(e))s.push(this.translateObject(r,o,i));return s}selectTranslateObject(e,n,i){if(b(e)||Array.isArray(e))return this.selectTranslate(e,n,i,!0);let[[s,r],...o]=this.getEntries(e);return this.selectTranslateObject(s,r,i).pipe(T(c=>{let l=[c];for(let[u,d]of o)l.push(this.translateObject(u,d,i));return l}))}getTranslation(e){if(e){if(this.isLang(e))return this.translations.get(e)||{};{let{scope:n,resolveLang:i}=this.resolveLangAndScope(e),s=this.translations.get(i)||{};return this.getObjectByKey(s,n)}}return this.translations}selectTranslation(e){let n=this.langChanges$;if(e){let i=v(e)!==e;this.isLang(e)||i?n=w(e):n=this.langChanges$.pipe(T(s=>`${e}/${s}`))}return n.pipe(O(i=>this.load(i).pipe(T(()=>this.getTranslation(i)))))}setTranslation(e,n=this.getActiveLang(),i={}){let r=h(h({},{merge:!0,emitChange:!0}),i),o=C(n),c=e;if(o){let Se=this.getMappedScope(o);c=ue({[Se]:e})}let l=o?v(n):n,u=h(h({},r.merge&&this.getTranslation(l)),c),d=this.config.flatten.aot?u:ue(u),be=this.interceptor.preSaveTranslation(d,l);this.translations.set(l,be),r.emitChange&&this.setActiveLang(this.getActiveLang())}setTranslationKey(e,n,i={}){let s=i.lang||this.getActiveLang(),r=this.interceptor.preSaveTranslationKey(e,n,s),o={[e]:r};this.setTranslation(o,s,A(h({},i),{merge:!0}))}setFallbackLangForMissingTranslation({fallbackLang:e}){let n=Array.isArray(e)?e[0]:e;e&&this.useFallbackTranslation(n)&&(this.firstFallbackLang=n)}_handleMissingKey(e,n,i){if(this.config.missingHandler.allowEmpty&&n==="")return"";if(!this.isResolvedMissingOnce&&this.useFallbackTranslation()){this.isResolvedMissingOnce=!0;let s=this.translate(e,i,this.firstFallbackLang);return this.isResolvedMissingOnce=!1,s}return this.missingHandler.handle(e,this.getMissingHandlerData(),i)}_isLangScoped(e){return this.getAvailableLangsIds().indexOf(e)===-1}isLang(e){return this.getAvailableLangsIds().indexOf(e)!==-1}_loadDependencies(e,n){let i=v(e);return this._isLangScoped(e)&&!this.isLoadedTranslation(i)?z([this.load(i),this.load(e,{inlineLoader:n})]):this.load(e,{inlineLoader:n})}_completeScopeWithLang(e){return this._isLangScoped(e)&&!this.isLang(v(e))?`${e}/${this.getActiveLang()}`:e}_setScopeAlias(e,n){this.config.scopeMapping||(this.config.scopeMapping={}),this.config.scopeMapping[e]=n}ngOnDestroy(){this.cache.clear()}isLoadedTranslation(e){return de(this.getTranslation(e))}getAvailableLangsIds(){let e=this.getAvailableLangs()[0];return b(e)?this.getAvailableLangs():this.getAvailableLangs().map(n=>n.id)}getMissingHandlerData(){return A(h({},this.config),{activeLang:this.getActiveLang(),availableLangs:this.availableLangs,defaultLang:this.defaultLang})}useFallbackTranslation(e){return this.config.missingHandler.useFallbackTranslation&&e!==this.firstFallbackLang}handleSuccess(e,n){this.setTranslation(n,e,{emitChange:!1}),this.events.next({wasFailure:!!this.failedLangs.size,type:"translationLoadSuccess",payload:D(e)}),this.failedLangs.forEach(i=>this.cache.delete(i)),this.failedLangs.clear()}handleFailure(e,n){_(n.failedCounter)&&(n.failedCounter=0,n.fallbackLangs||(n.fallbackLangs=this.fallbackStrategy.getNextLangs(e)));let i=e.split("/"),r=n.fallbackLangs[n.failedCounter];if(this.failedLangs.add(e),this.cache.has(r))return this.handleSuccess(r,this.getTranslation(r)),G;let o=r===i[i.length-1];if(!r||o){let l="Unable to load translation and all the fallback languages";throw i.length>1&&(l+=", did you misspelled the scope name?"),new Error(l)}let c=r;return i.length>1&&(i[i.length-1]=r,c=i.join("/")),n.failedCounter++,this.events.next({type:"translationLoadFailure",payload:D(e)}),this.load(c,n)}getMappedScope(e){let{scopeMapping:n={},scopes:i={keepCasing:!1}}=this.config;return n[e]||(i.keepCasing?e:fe(e))}resolveLangAndScope(e){let n=e,i;if(this._isLangScoped(e)){let s=v(e),r=this.isLang(s);n=r?s:this.getActiveLang(),i=this.getMappedScope(r?C(e):e)}return{scope:i,resolveLang:n}}getObjectByKey(e,n){let i={},s=`${n}.`;for(let r in e)r.startsWith(s)&&(i[r.replace(s,"")]=e[r]);return i}getEntries(e){return e instanceof Map?e.entries():Object.entries(e)}static \u0275fac=function(n){return new(n||t)(p(he,8),p(pe),p(ve),p(Le),p(S),p(Te))};static \u0275prov=y({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Ve=(()=>{class t{html;static \u0275fac=function(n){return new(n||t)};static \u0275cmp=se({type:t,selectors:[["ng-component"]],inputs:{html:"html"},decls:1,vars:1,consts:[[1,"transloco-loader-template",3,"innerHTML"]],template:function(n,i){n&1&&le(0,"div",0),n&2&&oe("innerHTML",i.html,te)},encapsulation:2})}return t})(),P=class{view;vcr;constructor(a,e){this.view=a,this.vcr=e}attachView(){if(this.view instanceof F)this.vcr.createEmbeddedView(this.view);else if(b(this.view)){let a=this.vcr.createComponent(Ve);a.instance.html=this.view,a.hostView.detectChanges()}else this.vcr.createComponent(this.view)}detachView(){this.vcr.clear()}},He=new f("TRANSLOCO_LANG"),Ke=new f("TRANSLOCO_LOADING_TEMPLATE"),Be=new f("TRANSLOCO_SCOPE"),k=class{initialized=!1;resolve({inline:a,provider:e,active:n}){let i=n;if(this.initialized)return i=n,i;if(e){let[,s]=x(e,"static");i=s}if(a){let[,s]=x(a,"static");i=s}return this.initialized=!0,i}resolveLangBasedOnScope(a){return C(a)?v(a):a}resolveLangPath(a,e){return e?`${e}/${a}`:a}},V=class{service;constructor(a){this.service=a}resolve(a){let{inline:e,provider:n}=a;if(e)return e;if(n){if(ge(n)){let{scope:i,alias:s=this.service.config.scopes.keepCasing?i:fe(i)}=n;return this.service._setScopeAlias(i,s),i}return n}}},ft=(()=>{class t{destroyRef=g(X);service=g(ke);tpl=g(F,{optional:!0});providerLang=g(He,{optional:!0});providerScope=g(Be,{optional:!0});providedLoadingTpl=g(Ke,{optional:!0});cdr=g(j);host=g(ee);vcr=g(ie);renderer=g(ne);view;memo=new Map;key;params={};inlineScope;inlineRead;prefix;inlineLang;inlineTpl;currentLang;loaderTplHandler;initialized=!1;path;langResolver=new k;scopeResolver=new V(this.service);strategy=this.tpl===null?"attribute":"structural";static ngTemplateContextGuard(e,n){return!0}ngOnInit(){let e=De(this.service,this.providerLang||this.inlineLang);if(this.service.langChanges$.pipe(O(n=>{let i=this.langResolver.resolve({inline:this.inlineLang,provider:this.providerLang,active:n});return Array.isArray(this.providerScope)?N(this.providerScope.map(s=>this.resolveScope(i,s))):this.resolveScope(i,this.providerScope)}),Ee(e),$(this.destroyRef)).subscribe(()=>{this.currentLang=this.langResolver.resolveLangBasedOnScope(this.path),this.strategy==="attribute"?this.attributeStrategy():this.structuralStrategy(this.currentLang,this.prefix||this.inlineRead),this.cdr.markForCheck(),this.initialized=!0}),!this.initialized){let n=this.resolveLoadingContent();n&&(this.loaderTplHandler=new P(n,this.vcr),this.loaderTplHandler.attachView())}}ngOnChanges(e){this.strategy==="attribute"&&Object.keys(e).some(i=>!e[i].firstChange)&&this.attributeStrategy()}attributeStrategy(){this.detachLoader(),this.renderer.setProperty(this.host.nativeElement,"innerText",this.service.translate(this.key,this.params,this.currentLang))}structuralStrategy(e,n){this.memo.clear();let i=this.getTranslateFn(e,n);this.view?(this.view.context.$implicit=i,this.view.context.currentLang=this.currentLang):(this.detachLoader(),this.view=this.vcr.createEmbeddedView(this.tpl,{$implicit:i,currentLang:this.currentLang}))}getTranslateFn(e,n){return(i,s)=>{let r=n?`${n}.${i}`:i,o=s?`${r}${JSON.stringify(s)}`:r;return this.memo.has(o)||this.memo.set(o,this.service.translate(r,s,e)),this.memo.get(o)}}resolveLoadingContent(){return this.inlineTpl||this.providedLoadingTpl}ngOnDestroy(){this.memo.clear()}detachLoader(){this.loaderTplHandler?.detachView()}resolveScope(e,n){let i=this.scopeResolver.resolve({inline:this.inlineScope,provider:n});this.path=this.langResolver.resolveLangPath(e,i);let s=ye(n,i);return this.service._loadDependencies(this.path,s)}static \u0275fac=function(n){return new(n||t)};static \u0275dir=ae({type:t,selectors:[["","transloco",""]],inputs:{key:[0,"transloco","key"],params:[0,"translocoParams","params"],inlineScope:[0,"translocoScope","inlineScope"],inlineRead:[0,"translocoRead","inlineRead"],prefix:[0,"translocoPrefix","prefix"],inlineLang:[0,"translocoLang","inlineLang"],inlineTpl:[0,"translocoLoadingTpl","inlineTpl"]},features:[Q]})}return t})();var gt=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=re({type:t});static \u0275inj=q({})}return t})();function pt(t){let a=[Je(Ne),Ye(je),Ue($e),We(Ie)];return t.config&&a.push(Ge(t.config)),t.loader&&a.push(ze(t.loader)),a}function Ge(t){return L([{provide:S,useValue:Me(t)}])}function ze(t){return L([{provide:he,useClass:t}])}function Je(t){return L([{provide:pe,useClass:t,deps:[S]}])}function We(t){return L([{provide:Te,useClass:t,deps:[S]}])}function Ye(t){return L([{provide:ve,useClass:t}])}function Ue(t){return L([{provide:Le,useClass:t}])}var vt=new f("TRANSLOCO_TEST_LANGS - Available testing languages"),Lt=new f("TRANSLOCO_TEST_OPTIONS - Testing options");export{ke as a,ft as b,gt as c,pt as d};
