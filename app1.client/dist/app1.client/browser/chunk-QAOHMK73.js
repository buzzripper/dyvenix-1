import{a as De,b as ct,c as mt,d as pt,e as ut,f as ft}from"./chunk-YVNTLP2V.js";import{a as ot,b as nt,d as at,e as st,f as lt,g as dt}from"./chunk-RFEFAVBM.js";import{a as Ke}from"./chunk-KSO6IQS5.js";import{a as $e,c as Ue}from"./chunk-S2KWTDMG.js";import{b as N}from"./chunk-6HA7Q7P5.js";import{a as Je,b as We,c as Xe,d as Ye}from"./chunk-TKBKLS4N.js";import{a as qe}from"./chunk-YCUPTL4E.js";import"./chunk-EMSJVJHN.js";import{b as Ce}from"./chunk-7XX3TVDI.js";import"./chunk-SSJR24MO.js";import"./chunk-6UHTTYRU.js";import{a as it,b as rt}from"./chunk-A3WCOMYE.js";import{a as ye,b as we,d as et,e as tt}from"./chunk-2ZTHJEDW.js";import{a as Pe,i as Ge,j as Qe}from"./chunk-FEENJMQR.js";import"./chunk-EDL6DMK5.js";import{b as X,d as Ze,g as Y,h as Z,m as ee,p as te,s as ie,w as G,x as re,y as oe}from"./chunk-WRLPWSZF.js";import{a as $,b as He,c as U,e as P}from"./chunk-22IZ7S6Q.js";import{b as M,c as V}from"./chunk-ZDVCYR6D.js";import"./chunk-25LMPTPI.js";import"./chunk-AUKJIIL4.js";import"./chunk-SVUIAZ5I.js";import{b as Oe,c as Ne,d as ce,e as xe}from"./chunk-IKG45PLY.js";import{c as ze}from"./chunk-OYH67EY7.js";import{h as O,p as ge}from"./chunk-DBYYYE4O.js";import{$ as w,Cb as z,Da as ue,Dc as Re,E as Ie,Ec as S,Gc as je,H as Le,J as k,Kb as d,Kc as _e,Mb as be,Mc as ve,Qb as de,Rb as D,Ub as L,Uc as F,Vb as E,Wb as s,Xb as c,Y as I,Yb as u,Z as j,ac as A,ca as Ee,eb as fe,f as J,g as pe,gc as h,ha as Ae,hb as n,ia as W,ib as _,ic as v,m as Te,mc as Q,n as le,nc as q,oc as H,r as g,sc as K,ta as f,tc as m,ua as b,uc as he,vc as C,wb as y}from"./chunk-Q34RPHHW.js";import{a as Be}from"./chunk-WWX6BADO.js";var me=class{constructor(l){this.id=l.id||null,this.title=l.title,this.description=l.description||null,this.icon=l.icon||null,this.lastActivity=l.lastActivity||null,this.lists=[],this.labels=[],this.members=[],l.lists&&(this.lists=l.lists.map(e=>e instanceof B?e:new B(e))),l.labels&&(this.labels=l.labels.map(e=>e instanceof ne?e:new ne(e))),l.members&&(this.members=l.members.map(e=>e instanceof Se?e:new Se(e)))}},B=class{constructor(l){this.id=l.id||null,this.boardId=l.boardId,this.position=l.position,this.title=l.title,this.cards=[],l.cards&&(this.cards=l.cards.map(e=>e instanceof R?e:new R(e)))}},R=class{constructor(l){this.id=l.id||null,this.boardId=l.boardId,this.listId=l.listId,this.position=l.position,this.title=l.title,this.description=l.description||null,this.labels=[],this.dueDate=l.dueDate||null,l.labels&&(this.labels=l.labels.map(e=>e instanceof ne?e:new ne(e)))}},Se=class{constructor(l){this.id=l.id||null,this.name=l.name,this.avatar=l.avatar||null}},ne=class{constructor(l){this.id=l.id||null,this.boardId=l.boardId,this.title=l.title}};var yt=["titleInput"],wt=["titleAutosize"],St=o=>({"pointer-events-none opacity-0":o}),kt=o=>({"opacity-0":o}),bt=(()=>{class o{constructor(e,t){this._changeDetectorRef=e,this._formBuilder=t,this.buttonTitle="Add a card",this.saved=new ue,this.formVisible=!1}ngOnInit(){this.form=this._formBuilder.group({title:[""]})}save(){let e=this.form.get("title").value;!e||e.trim()===""||(this.saved.next(e.trim()),this.formVisible=!1,this.form.get("title").setValue(""),setTimeout(()=>{this.titleInput.nativeElement.value="",this.titleAutosize.reset()}),this._changeDetectorRef.markForCheck())}toggleFormVisibility(){this.formVisible=!this.formVisible,this.formVisible&&this.titleInput.nativeElement.focus()}static{this.\u0275fac=function(t){return new(t||o)(_(F),_(G))}}static{this.\u0275cmp=y({type:o,selectors:[["scrumboard-board-add-card"]],viewQuery:function(t,i){if(t&1&&(Q(yt,5),Q(wt,5)),t&2){let r;q(r=H())&&(i.titleInput=r.first),q(r=H())&&(i.titleAutosize=r.first)}},inputs:{buttonTitle:"buttonTitle"},outputs:{saved:"saved"},decls:17,vars:18,consts:[["titleInput","","titleAutosize","cdkTextareaAutosize"],[1,"p-3","pt-0"],[1,"relative","flex","h-full","w-full","rounded-lg"],["mat-button","","disableRipple","",1,"absolute","inset-0","w-full","justify-start","rounded-lg",3,"click","ngClass"],[1,"icon-size-5",3,"svgIcon"],[1,"text-secondary","ml-2"],[1,"flex","w-full","flex-col","items-start",3,"ngClass","formGroup"],[1,"bg-card","flex","w-full","rounded-lg","p-5","shadow"],["cdkTextareaAutosize","",1,"w-full","text-lg","font-medium","leading-5",3,"keydown.enter","spellcheck","formControlName","placeholder"],[1,"mt-2","flex","items-center"],["mat-flat-button","",1,"h-8","min-h-8",3,"click","color","type"],["mat-icon-button","",1,"ml-1","h-8","min-h-8","w-8",3,"click","type"],[1,"icon-size-4",3,"svgIcon"]],template:function(t,i){if(t&1){let r=A();s(0,"div",1)(1,"div",2)(2,"button",3),h("click",function(){return f(r),b(i.toggleFormVisibility())}),u(3,"mat-icon",4),s(4,"span",5),m(5),c()(),s(6,"form",6)(7,"div",7)(8,"textarea",8,0),h("keydown.enter",function(){return f(r),b(i.save())}),m(11,"                "),c()(),s(12,"div",9)(13,"button",10),h("click",function(){return f(r),b(i.save())}),m(14," Add card "),c(),s(15,"button",11),h("click",function(){return f(r),b(i.toggleFormVisibility())}),u(16,"mat-icon",12),c()()()()()}t&2&&(be("h-13",!i.formVisible),n(2),d("ngClass",S(14,St,i.formVisible)),n(),d("svgIcon","heroicons_outline:plus-circle"),n(2),he(i.buttonTitle),n(),d("ngClass",S(16,kt,!i.formVisible))("formGroup",i.form),n(2),d("spellcheck","off")("formControlName","title")("placeholder","Enter card title..."),n(5),d("color","primary")("type","button"),n(2),d("type","button"),n(),d("svgIcon","heroicons_solid:x-mark"))},dependencies:[P,$,U,O,V,M,re,ee,X,Y,Z,oe,te,ie,we,ye],encapsulation:2,changeDetection:0})}}return o})();var It=["titleInput"],Dt=o=>({"pointer-events-none opacity-0":o}),Ft=o=>({"opacity-0":o}),ht=(()=>{class o{constructor(e,t){this._changeDetectorRef=e,this._formBuilder=t,this.buttonTitle="Add a list",this.saved=new ue,this.formVisible=!1}ngOnInit(){this.form=this._formBuilder.group({title:[""]})}save(){let e=this.form.get("title").value;!e||e.trim()===""||(this.saved.next(e.trim()),this.form.get("title").setValue(""),this.formVisible=!1,this._changeDetectorRef.markForCheck())}toggleFormVisibility(){this.formVisible=!this.formVisible,this.formVisible&&this.titleInput.nativeElement.focus()}static{this.\u0275fac=function(t){return new(t||o)(_(F),_(G))}}static{this.\u0275cmp=y({type:o,selectors:[["scrumboard-board-add-list"]],viewQuery:function(t,i){if(t&1&&Q(It,5),t&2){let r;q(r=H())&&(i.titleInput=r.first)}},inputs:{buttonTitle:"buttonTitle"},outputs:{saved:"saved"},decls:14,vars:18,consts:[["titleInput",""],[1,"mt-11","w-64","px-2","py-2.5"],[1,"relative","flex","h-full","w-full","overflow-hidden","rounded-xl","bg-gray-200","dark:bg-gray-700"],["mat-button","","disableRipple","",1,"absolute","inset-0","w-full","justify-start","rounded-xl","bg-transparent","px-3",3,"click","ngClass"],[1,"icon-size-5",3,"svgIcon"],[1,"text-secondary","ml-2"],[1,"flex","w-full","flex-col","items-start","p-3",3,"ngClass","formGroup"],[1,"w-full","rounded-md","border","border-gray-300","bg-white","px-3","py-2","leading-5","shadow-sm","focus:border-primary","dark:border-gray-500","dark:bg-black","dark:bg-opacity-5","dark:focus:border-primary",3,"keydown.enter","autocomplete","formControlName","placeholder"],[1,"mt-2","flex","items-center"],["mat-flat-button","",1,"h-8","min-h-8",3,"click","color","type"],["mat-icon-button","",1,"ml-1","h-8","min-h-8","w-8",3,"click","type"],[1,"icon-size-4",3,"svgIcon"]],template:function(t,i){if(t&1){let r=A();s(0,"div",1)(1,"div",2)(2,"button",3),h("click",function(){return f(r),b(i.toggleFormVisibility())}),u(3,"mat-icon",4),s(4,"span",5),m(5),c()(),s(6,"form",6)(7,"input",7,0),h("keydown.enter",function(){return f(r),b(i.save())}),c(),s(9,"div",8)(10,"button",9),h("click",function(){return f(r),b(i.save())}),m(11," Add list "),c(),s(12,"button",10),h("click",function(){return f(r),b(i.toggleFormVisibility())}),u(13,"mat-icon",11),c()()()()()}t&2&&(be("h-15",!i.formVisible),n(2),d("ngClass",S(14,Dt,i.formVisible)),n(),d("svgIcon","heroicons_outline:plus-circle"),n(2),he(i.buttonTitle),n(),d("ngClass",S(16,Ft,!i.formVisible))("formGroup",i.form),n(),d("autocomplete","off")("formControlName","title")("placeholder","Enter list title..."),n(3),d("color","primary")("type","button"),n(2),d("type","button"),n(),d("svgIcon","heroicons_solid:x-mark"))},dependencies:[P,$,U,O,V,M,re,ee,X,Y,Z,oe,te,ie],encapsulation:2,changeDetection:0})}}return o})();var T=(()=>{class o{constructor(e){this._httpClient=e,this._board=new pe(null),this._boards=new pe(null),this._card=new pe(null)}get board$(){return this._board.asObservable()}get boards$(){return this._boards.asObservable()}get card$(){return this._card.asObservable()}getBoards(){return this._httpClient.get("api/apps/scrumboard/boards").pipe(g(e=>e.map(t=>new me(t))),w(e=>this._boards.next(e)))}getBoard(e){return this._httpClient.get("api/apps/scrumboard/board",{params:{id:e}}).pipe(g(t=>new me(t)),w(t=>this._board.next(t)))}createBoard(e){return this.boards$.pipe(k(1),I(t=>this._httpClient.put("api/apps/scrumboard/board",{board:e}).pipe(g(i=>(this._boards.next([...t,i]),i)))))}updateBoard(e,t){return this.boards$.pipe(k(1),I(i=>this._httpClient.patch("api/apps/scrumboard/board",{id:e,board:t}).pipe(g(r=>{let a=i.findIndex(p=>p.id===e);return i[a]=r,this._boards.next(i),r}))))}deleteBoard(e){return this.boards$.pipe(k(1),I(t=>this._httpClient.delete("api/apps/scrumboard/board",{params:{id:e}}).pipe(g(i=>{let r=t.findIndex(a=>a.id===e);return t.splice(r,1),this._boards.next(t),this._board.next(null),this._card.next(null),i}))))}createList(e){return this._httpClient.post("api/apps/scrumboard/board/list",{list:e}).pipe(g(t=>new B(t)),w(t=>{let i=this._board.value;i.lists=[...i.lists,t],i.lists.sort((r,a)=>r.position-a.position),this._board.next(i)}))}updateList(e){return this._httpClient.patch("api/apps/scrumboard/board/list",{list:e}).pipe(g(t=>new B(t)),w(t=>{let i=this._board.value,r=i.lists.findIndex(a=>a.id===e.id);i.lists[r]=t,i.lists.sort((a,p)=>a.position-p.position),this._board.next(i)}))}updateLists(e){return this._httpClient.patch("api/apps/scrumboard/board/lists",{lists:e}).pipe(g(t=>t.map(i=>new B(i))),w(t=>{let i=this._board.value;t.forEach(r=>{let a=i.lists.findIndex(p=>p.id===r.id);i.lists[a]=r}),i.lists.sort((r,a)=>r.position-a.position),this._board.next(i)}))}deleteList(e){return this._httpClient.delete("api/apps/scrumboard/board/list",{params:{id:e}}).pipe(w(t=>{let i=this._board.value,r=i.lists.findIndex(a=>a.id===e);i.lists.splice(r,1),i.lists.sort((a,p)=>a.position-p.position),this._board.next(i)}))}getCard(e){return this._board.pipe(k(1),g(t=>{let i=t.lists.find(r=>r.cards.some(a=>a.id===e)).cards.find(r=>r.id===e);return this._card.next(i),i}),I(t=>t?Te(t):le("Could not found the card with id of "+e+"!")))}createCard(e){return this._httpClient.put("api/apps/scrumboard/board/card",{card:e}).pipe(g(t=>new R(t)),w(t=>{let i=this._board.value;return i.lists.forEach((r,a,p)=>{r.id===t.listId&&p[a].cards.push(t)}),this._board.next(i),t}))}updateCard(e,t){return this.board$.pipe(k(1),I(i=>this._httpClient.patch("api/apps/scrumboard/board/card",{id:e,card:t}).pipe(g(r=>(i.lists.forEach(a=>{a.cards.forEach((p,x,se)=>{p.id===e&&(se[x]=r)})}),this._board.next(i),this._card.next(r),r)))))}updateCards(e){return this._httpClient.patch("api/apps/scrumboard/board/cards",{cards:e}).pipe(g(t=>t.map(i=>new R(i))),w(t=>{let i=this._board.value;t.forEach(r=>{let a=i.lists.findIndex(x=>x.id===r.listId),p=i.lists[a].cards.findIndex(x=>x.id===r.id);i.lists[a].cards[p]=r,i.lists[a].cards.sort((x,se)=>x.position-se.position)}),this._board.next(i)}))}deleteCard(e){return this.board$.pipe(k(1),I(t=>this._httpClient.delete("api/apps/scrumboard/board/card",{params:{id:e}}).pipe(g(i=>(t.lists.forEach(r=>{r.cards.forEach((a,p,x)=>{a.id===e&&x.splice(p,1)})}),this._board.next(t),this._card.next(null),i)))))}createLabel(e){return this.board$.pipe(k(1),I(t=>this._httpClient.post("api/apps/scrumboard/board/label",{label:e}).pipe(g(i=>(t.labels=[...t.labels,i],this._board.next(t),i)))))}updateLabel(e,t){return this.board$.pipe(k(1),I(i=>this._httpClient.patch("api/apps/scrumboard/board/label",{id:e,label:t}).pipe(g(r=>{let a=i.labels.findIndex(p=>p.id===e);return i.labels[a]=r,this._board.next(i),r}))))}deleteLabel(e){return this.board$.pipe(k(1),I(t=>this._httpClient.delete("api/apps/scrumboard/board/label",{params:{id:e}}).pipe(g(i=>{let r=t.labels.findIndex(a=>a.id===e);return t.labels.splice(r,1),i&&t.lists.forEach(a=>{a.cards.forEach(p=>{let x=p.labels.findIndex(se=>se.id===e);x>-1&&p.labels.splice(x,1)})}),this._board.next(t),i}))))}search(e){return this._httpClient.get("api/apps/scrumboard/board/search",{params:{query:e}})}static{this.\u0275fac=function(t){return new(t||o)(Ae(ze))}}static{this.\u0275prov=Ee({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var Mt=()=>[".."],Vt=o=>["card",o],Bt=o=>({"text-red-600":o});function Tt(o,l){if(o&1&&(s(0,"div",27),u(1,"img",30),c()),o&2){let e=v().$implicit;n(),d("src",e.coverImage,fe)}}function Lt(o,l){if(o&1&&(s(0,"div",32),m(1),c()),o&2){let e=l.$implicit;n(),C(" ",e.title," ")}}function Et(o,l){if(o&1&&(s(0,"div")(1,"div",31),L(2,Lt,2,1,"div",32,de().trackByFn,!0),c()()),o&2){let e=v().$implicit;n(2),E(e.labels)}}function At(o,l){if(o&1&&(s(0,"div",29),u(1,"mat-icon",33),s(2,"div",21),m(3),_e(4,"date"),c()()),o&2){let e=v().$implicit,t=v(2);d("ngClass",S(6,Bt,t.isOverdue(e.dueDate))),n(),d("svgIcon","heroicons_outline:clock"),n(2),C(" ",ve(4,3,e.dueDate,"longDate")," ")}}function Rt(o,l){if(o&1&&(s(0,"a",26),z(1,Tt,2,1,"div",27),s(2,"div",28),m(3),c(),z(4,Et,4,0,"div")(5,At,5,8,"div",29),c()),o&2){let e=l.$implicit;d("routerLink",S(5,Vt,e.id)),n(),D(e.coverImage?1:-1),n(2),C(" ",e.title," "),n(),D(e.labels.length?4:-1),n(),D(e.dueDate?5:-1)}}function jt(o,l){if(o&1){let e=A();s(0,"div",14)(1,"div",17)(2,"div",18)(3,"input",19,0),h("focusout",function(i){let r=f(e).$implicit,a=v();return b(a.updateListTitle(i,r))})("keydown.enter",function(){f(e);let i=K(4);return b(i.blur())}),c()(),s(5,"div",20),m(6),c(),s(7,"div",21)(8,"button",22),u(9,"mat-icon",8),c(),s(10,"mat-menu",null,1)(12,"button",23),h("click",function(){f(e);let i=K(4),r=v();return b(r.renameList(i))}),u(13,"mat-icon",8),m(14," Rename list "),c(),s(15,"button",23),h("click",function(){let i=f(e).$implicit,r=v();return b(r.deleteList(i.id))}),u(16,"mat-icon",8),m(17," Delete list "),c()()()(),s(18,"div",24)(19,"div",25),h("cdkDropListDropped",function(i){f(e);let r=v();return b(r.cardDropped(i))}),L(20,Rt,6,7,"a",26,de().trackByFn,!0),c(),s(22,"scrumboard-board-add-card",15),h("saved",function(i){let r=f(e).$implicit,a=v();return b(a.addCard(r,i))}),c()()()}if(o&2){let e=l.$implicit,t=K(11);d("cdkDragLockAxis","x"),n(3),d("spellcheck","false")("value",e.title),n(3),C(" ",e.cards.length," "),n(2),d("matMenuTriggerFor",t),n(),d("svgIcon","heroicons_solid:ellipsis-vertical"),n(4),d("svgIcon","heroicons_solid:pencil-square"),n(3),d("svgIcon","heroicons_solid:trash"),n(3),d("id",e.id)("cdkDropListData",e.cards),n(),E(e.cards),n(2),d("buttonTitle",e.cards.length?"Add another card":"Add a card")}}var _t=(()=>{class o{constructor(e,t,i,r){this._changeDetectorRef=e,this._formBuilder=t,this._fuseConfirmationService=i,this._scrumboardService=r,this._positionStep=65536,this._maxListCount=200,this._maxPosition=this._positionStep*500,this._unsubscribeAll=new J}ngOnInit(){this.listTitleForm=this._formBuilder.group({title:[""]}),this._scrumboardService.board$.pipe(j(this._unsubscribeAll)).subscribe(e=>{this.board=Be({},e),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}renameList(e){setTimeout(()=>{e.focus()})}addList(e){if(this.board.lists.length>=this._maxListCount)return;let t=new B({boardId:this.board.id,position:this.board.lists.length?this.board.lists[this.board.lists.length-1].position+this._positionStep:this._positionStep,title:e});this._scrumboardService.createList(t).subscribe()}updateListTitle(e,t){let i=e.target,r=i.value;if(!r||r.trim()===""){i.value=t.title;return}t.title=i.value=r.trim(),this._scrumboardService.updateList(t).subscribe()}deleteList(e){this._fuseConfirmationService.open({title:"Delete list",message:"Are you sure you want to delete this list and its cards? This action cannot be undone!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(i=>{i==="confirmed"&&this._scrumboardService.deleteList(e).subscribe()})}addCard(e,t){let i=new R({boardId:this.board.id,listId:e.id,position:e.cards.length?e.cards[e.cards.length-1].position+this._positionStep:this._positionStep,title:t});this._scrumboardService.createCard(i).subscribe()}listDropped(e){De(e.container.data,e.previousIndex,e.currentIndex);let t=this._calculatePositions(e);this._scrumboardService.updateLists(t).subscribe()}cardDropped(e){e.previousContainer===e.container?De(e.container.data,e.previousIndex,e.currentIndex):(ct(e.previousContainer.data,e.container.data,e.previousIndex,e.currentIndex),e.container.data[e.currentIndex].listId=e.container.id);let t=this._calculatePositions(e);this._scrumboardService.updateCards(t).subscribe()}isOverdue(e){return N.fromISO(e).startOf("day")<N.now().startOf("day")}trackByFn(e,t){return t.id||e}_calculatePositions(e){let t=e.container.data,i=t[e.currentIndex],r=t[e.currentIndex-1]||null,a=t[e.currentIndex+1]||null;return r?a?i.position=(r.position+a.position)/2:i.position=r.position+this._positionStep:a?i.position=a.position/2:i.position=this._positionStep,!Number.isInteger(i.position)||i.position>=this._maxPosition?(t=t.map((p,x)=>(p.position=(x+1)*this._positionStep,p)),t):[i]}static{this.\u0275fac=function(t){return new(t||o)(_(F),_(G),_(Ke),_(T))}}static{this.\u0275cmp=y({type:o,selectors:[["scrumboard-board"]],decls:22,vars:8,consts:[["listTitleInput",""],["listMenu","matMenu"],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"bg-card","flex","flex-0","flex-col","border-b","p-6","dark:bg-transparent","sm:flex-row","sm:items-center","sm:justify-between","sm:px-10","sm:py-8"],[1,"min-w-0","flex-1"],[1,"truncate","text-3xl","font-extrabold","leading-7","tracking-tight","sm:leading-10","md:text-4xl"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],["mat-stroked-button","",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2"],["mat-stroked-button","",1,"ml-3"],["cdkScrollable","",1,"flex-auto","overflow-y-auto","p-6","sm:p-8","sm:pt-4"],["cdkDropList","",1,"flex",3,"cdkDropListDropped","cdkDropListData","cdkDropListOrientation"],["cdkDropListGroup","",1,"flex","items-start"],["cdkDrag","",1,"bg-default","w-72","flex-0","rounded-2xl","p-2",3,"cdkDragLockAxis"],[3,"saved","buttonTitle"],[1,"pointer-events-none","invisible","absolute","h-0","w-0","opacity-0"],["cdkDragHandle","",1,"flex","items-center","justify-between"],[1,"flex","w-full","cursor-text","items-center","rounded-md","border","border-transparent","px-3","py-2","focus-within:border-primary","focus-within:bg-white","focus-within:shadow-sm","dark:focus-within:bg-gray-900"],[1,"w-full","bg-transparent","font-medium","leading-5",3,"focusout","keydown.enter","spellcheck","value"],[1,"text-secondary","ml-4","flex","min-w-6","items-center","justify-center","rounded-full","bg-gray-300","text-sm","font-semibold","leading-6","dark:bg-gray-700"],[1,"ml-1"],["mat-icon-button","",1,"h-8","min-h-8","w-8",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"mt-2","rounded-xl","bg-gray-400","bg-opacity-12","dark:border","dark:bg-transparent"],["cdkDropList","",1,"p-3","pb-0",3,"cdkDropListDropped","id","cdkDropListData"],["cdkDrag","",1,"bg-card","mb-3","flex","flex-col","items-start","space-y-3","overflow-hidden","rounded-lg","p-5","shadow",3,"routerLink"],[1,"-mx-5","-mt-5","mb-2"],[1,"text-lg","font-medium","leading-5"],[1,"text-secondary","flex","items-center","rounded","text-sm","font-medium","leading-5",3,"ngClass"],[1,"w-full","object-cover",3,"src"],[1,"-mx-1","-mb-2","flex","flex-wrap"],[1,"mx-1","mb-2","rounded-full","bg-gray-100","px-3","py-0.5","text-sm","font-medium","text-gray-500","dark:bg-gray-700","dark:text-gray-300"],[1,"text-current","icon-size-4",3,"svgIcon"]],template:function(t,i){t&1&&(s(0,"div",2)(1,"div",3)(2,"div",4)(3,"h2",5),m(4),c()(),s(5,"div",6)(6,"a",7),u(7,"mat-icon",8),s(8,"span",9),m(9,"Boards"),c()(),s(10,"button",10),u(11,"mat-icon",8),s(12,"span",9),m(13,"Settings"),c()()()(),s(14,"div",11)(15,"div",12),h("cdkDropListDropped",function(a){return i.listDropped(a)}),s(16,"div",13),L(17,jt,23,11,"div",14,i.trackByFn,!0),s(19,"scrumboard-board-add-list",15),h("saved",function(a){return i.addList(a)}),c()()()()(),s(20,"div",16),u(21,"router-outlet"),c()),t&2&&(n(4),C(" ",i.board.title," "),n(2),d("routerLink",Re(7,Mt)),n(),d("svgIcon","heroicons_solid:view-columns"),n(4),d("svgIcon","heroicons_solid:cog-8-tooth"),n(4),d("cdkDropListData",i.board.lists)("cdkDropListOrientation","horizontal"),n(2),E(i.board.lists),n(2),d("buttonTitle",i.board.lists.length?"Add another list":"Add a list"))},dependencies:[P,He,$,U,xe,V,M,Ce,ft,ut,pt,mt,Ye,We,Je,Xe,O,bt,ht,Ne,ge],styles:[`.cdk-drag-preview{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.cdk-drag-placeholder{opacity:0}.cdk-drag-animating{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging div:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}
`],encapsulation:2,changeDetection:0})}}return o})();var zt=o=>[o];function Ot(o,l){if(o&1&&u(0,"img",16),o&2){let e=l.$implicit;d("src",e.avatar,fe)}}function Nt(o,l){if(o&1&&(s(0,"div",17)(1,"div",18),m(2),c()()),o&2){let e=v(2).$implicit;n(2),C(" +",e.members.slice(5).length," ")}}function $t(o,l){if(o&1&&(u(0,"div",14),s(1,"div",15),L(2,Ot,1,1,"img",16,de().trackByFn,!0),z(4,Nt,3,1,"div",17),c()),o&2){let e=v().$implicit;n(2),E(e.members.slice(0,5)),n(2),D(e.members.length>5?4:-1)}}function Ut(o,l){if(o&1&&(s(0,"a",4)(1,"div",7),u(2,"mat-icon",8),c(),s(3,"div",9),m(4),c(),s(5,"div",10),m(6),c(),z(7,$t,5,1),s(8,"div",11)(9,"div",12),m(10,"Edited:"),c(),s(11,"div",13),m(12),c()()()),o&2){let e=l.$implicit,t=v();d("routerLink",S(6,zt,e.id)),n(2),d("svgIcon",e.icon),n(2),C(" ",e.title," "),n(2),C(" ",e.description," "),n(),D(e.members!=null&&e.members.length?7:-1),n(5),C(" ",t.formatDateAsRelative(e.lastActivity)," ")}}var vt=(()=>{class o{constructor(e,t){this._changeDetectorRef=e,this._scrumboardService=t,this._unsubscribeAll=new J}ngOnInit(){this._scrumboardService.boards$.pipe(j(this._unsubscribeAll)).subscribe(e=>{this.boards=e,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}formatDateAsRelative(e){return N.fromISO(e).toRelative()}trackByFn(e,t){return t.id||e}static{this.\u0275fac=function(t){return new(t||o)(_(F),_(T))}}static{this.\u0275cmp=y({type:o,selectors:[["scrumboard-boards"]],decls:9,vars:1,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-y-auto"],[1,"flex","flex-auto","flex-col","items-center","p-6","sm:p-10"],[1,"mt-4","text-3xl","font-extrabold","leading-7","tracking-tight","sm:leading-10","md:mt-24","md:text-6xl"],[1,"mt-8","grid","grid-cols-1","gap-4","sm:grid-cols-2","md:mt-16","lg:grid-cols-4"],[1,"bg-card","flex","w-56","flex-col","items-start","rounded-lg","p-6","shadow","transition-shadow","duration-150","ease-in-out","hover:shadow-xl",3,"routerLink"],[1,"flex","w-56","cursor-pointer","flex-col","items-center","justify-center","rounded-lg","border-2","border-dashed","border-gray-300","transition-colors","duration-150","ease-in-out","hover:bg-hover"],[1,"text-hint","icon-size-12",3,"svgIcon"],[1,"flex","items-center","justify-center","rounded-full","bg-primary-50","p-4","text-primary-700","dark:bg-primary","dark:text-on-primary"],[1,"text-current",3,"svgIcon"],[1,"mt-5","text-lg","font-medium","leading-5"],[1,"text-secondary","mt-0.5","line-clamp-2"],[1,"font-md","mt-4","flex","items-center","text-md"],[1,"text-secondary"],[1,"ml-1"],[1,"mt-6","h-1","w-12","border-t-2"],[1,"mt-6","flex","items-center","-space-x-1.5"],["alt","Member avatar",1,"ring-bg-card","h-8","w-8","flex-0","rounded-full","object-cover","ring","ring-offset-1","ring-offset-transparent",3,"src"],[1,"ring-bg-card","flex","h-8","w-8","flex-0","items-center","justify-center","rounded-full","bg-gray-200","text-gray-500","ring","ring-offset-1","ring-offset-transparent"],[1,"text-md","font-semibold"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2),m(3," Scrumboard Boards "),c(),s(4,"div",3),L(5,Ut,13,8,"a",4,i.trackByFn,!0),s(7,"div",5),u(8,"mat-icon",6),c()()()()),t&2&&(n(5),E(i.boards),n(3),d("svgIcon","heroicons_outline:plus"))},dependencies:[Ce,xe,V,M],encapsulation:2,changeDetection:0})}}return o})();var Gt=["labelInput"],Qt=(o,l,e)=>({"bg-gray-100 text-gray-500 dark:bg-gray-700 dark:text-gray-300":o,"bg-green-200 text-green-800 dark:bg-green-500 dark:text-green-100":l,"bg-red-200 text-red-800 dark:bg-red-500 dark:text-red-100":e});function qt(o,l){if(o&1&&(m(0),_e(1,"date")),o&2){let e=v();C(" ",ve(1,1,e.card.dueDate,"longDate")," ")}}function Ht(o,l){o&1&&m(0," Not set ")}function Kt(o,l){if(o&1){let e=A();s(0,"mat-checkbox",25),h("change",function(i){let r=f(e).$implicit,a=v();return b(a.toggleProductTag(r,i))}),m(1),c()}if(o&2){let e=l.$implicit,t=v();d("color","primary")("checked",t.hasLabel(e)),n(),C(" ",e.title," ")}}var gt=(()=>{class o{constructor(e,t,i,r){this.matDialogRef=e,this._changeDetectorRef=t,this._formBuilder=i,this._scrumboardService=r,this._unsubscribeAll=new J}ngOnInit(){this._scrumboardService.board$.pipe(j(this._unsubscribeAll)).subscribe(e=>{this.board=e,this.labels=this.filteredLabels=e.labels}),this._scrumboardService.card$.pipe(j(this._unsubscribeAll)).subscribe(e=>{this.card=e}),this.cardForm=this._formBuilder.group({id:[""],title:["",Ze.required],description:[""],labels:[[]],dueDate:[null]}),this.cardForm.setValue({id:this.card.id,title:this.card.title,description:this.card.description,labels:this.card.labels,dueDate:this.card.dueDate}),this.cardForm.valueChanges.pipe(w(e=>{this.card=qe(this.card,e)}),Le(300),j(this._unsubscribeAll)).subscribe(e=>{this._scrumboardService.updateCard(e.id,e).subscribe(),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}hasLabel(e){return!!this.card.labels.find(t=>t.id===e.id)}filterLabels(e){let t=e.target.value.toLowerCase();this.filteredLabels=this.labels.filter(i=>i.title.toLowerCase().includes(t))}filterLabelsInputKeyDown(e){if(e.key!=="Enter"||this.filteredLabels.length===0)return;let t=this.filteredLabels[0];this.card.labels.find(r=>r.id===t.id)?this.removeLabelFromCard(t):this.addLabelToCard(t)}toggleProductTag(e,t){t.checked?this.addLabelToCard(e):this.removeLabelFromCard(e)}addLabelToCard(e){this.card.labels.unshift(e),this.cardForm.get("labels").patchValue(this.card.labels),this._changeDetectorRef.markForCheck()}removeLabelFromCard(e){this.card.labels.splice(this.card.labels.findIndex(t=>t.id===e.id),1),this.cardForm.get("labels").patchValue(this.card.labels),this._changeDetectorRef.markForCheck()}isOverdue(e){return N.fromISO(e).startOf("day")<N.now().startOf("day")}trackByFn(e,t){return t.id||e}_readAsDataURL(e){return new Promise((t,i)=>{let r=new FileReader;r.onload=()=>{t(r.result)},r.onerror=a=>{i(a)},r.readAsDataURL(e)})}static{this.\u0275fac=function(t){return new(t||o)(_($e),_(F),_(G),_(T))}}static{this.\u0275cmp=y({type:o,selectors:[["scrumboard-card-details"]],viewQuery:function(t,i){if(t&1&&Q(Gt,5),t&2){let r;q(r=H())&&(i.labelInput=r.first)}},decls:45,vars:25,consts:[["dueDatePicker",""],[1,"-m-6","flex","max-h-160","flex-auto","flex-col","overflow-y-auto","md:w-160","md:min-w-160"],[1,"flex","h-16","flex-0","items-center","justify-between","bg-primary","pl-6","pr-3","text-on-primary","sm:pl-8","sm:pr-5"],[1,"text-lg","font-medium"],["mat-icon-button","",3,"click","tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","w-full","flex-0","flex-col","items-start","space-y-6","overflow-y-auto","p-6","sm:p-8",3,"formGroup"],[1,"w-full",3,"subscriptSizing"],["matInput","","cdkTextareaAutosize","",3,"formControlName","rows","cdkAutosizeMinRows"],[1,"font-medium"],[1,"relative","mt-1.5","flex","cursor-pointer","items-center","rounded-full","px-4","leading-9",3,"click","ngClass"],[1,"text-current","icon-size-5",3,"svgIcon"],[1,"ml-2","text-md","font-medium"],[1,"fuse-mat-dense","pointer-events-none","invisible","absolute","inset-0","-mt-2.5","opacity-0",3,"subscriptSizing"],["matInput","",3,"formControlName","matDatepicker"],["mat-button","","matDatepickerCancel","",3,"click"],["mat-flat-button","","matDatepickerApply","",3,"color"],[1,"w-full"],[1,"mt-1","overflow-hidden","rounded-md","border","border-gray-300","shadow-sm"],[1,"mx-3","my-2","flex","items-center"],[1,"flex","min-w-0","flex-auto","items-center"],[1,"icon-size-5",3,"svgIcon"],["type","text","placeholder","Enter label name",1,"ml-2","min-w-0","border-0","py-1",3,"input","keydown","maxLength"],[1,"max-h-40","overflow-y-auto","border-t","leading-none"],[1,"flex","h-10","min-h-10","items-center","pl-1","pr-4",3,"color","checked"],[1,"flex","h-10","min-h-10","items-center","pl-1","pr-4",3,"change","color","checked"]],template:function(t,i){if(t&1){let r=A();s(0,"div",1)(1,"div",2)(2,"div",3),m(3,"Card"),c(),s(4,"button",4),h("click",function(){return f(r),b(i.matDialogRef.close())}),u(5,"mat-icon",5),c()(),s(6,"form",6)(7,"mat-form-field",7)(8,"mat-label"),m(9,"Title"),c(),s(10,"textarea",8),m(11,"            "),c()(),s(12,"mat-form-field",7)(13,"mat-label"),m(14,"Description"),c(),s(15,"textarea",8),m(16,"            "),c()(),s(17,"div")(18,"div",9),m(19,"Due date"),c(),s(20,"div",10),h("click",function(){f(r);let p=K(28);return b(p.open())}),u(21,"mat-icon",11),s(22,"span",12),z(23,qt,2,4)(24,Ht,1,0),c(),s(25,"mat-form-field",13),u(26,"input",14),s(27,"mat-datepicker",null,0)(29,"mat-datepicker-actions")(30,"button",15),h("click",function(){return f(r),b(i.cardForm.get("dueDate").setValue(null))}),m(31," Clear "),c(),s(32,"button",16),m(33," Select "),c()()()()()(),s(34,"div",17)(35,"div",9),m(36,"Labels"),c(),s(37,"div",18)(38,"div",19)(39,"div",20),u(40,"mat-icon",21),s(41,"input",22),h("input",function(p){return f(r),b(i.filterLabels(p))})("keydown",function(p){return f(r),b(i.filterLabelsInputKeyDown(p))}),c()()(),s(42,"div",23),L(43,Kt,2,3,"mat-checkbox",24,i.trackByFn,!0),c()()()()()}if(t&2){let r=K(28);n(4),d("tabIndex",-1),n(),d("svgIcon","heroicons_outline:x-mark"),n(),d("formGroup",i.cardForm),n(),d("subscriptSizing","dynamic"),n(3),d("formControlName","title")("rows",1)("cdkAutosizeMinRows",1),n(2),d("subscriptSizing","dynamic"),n(3),d("formControlName","description")("rows",1)("cdkAutosizeMinRows",1),n(5),d("ngClass",je(21,Qt,!i.card.dueDate,i.card.dueDate&&!i.isOverdue(i.card.dueDate),i.card.dueDate&&i.isOverdue(i.card.dueDate))),n(),d("svgIcon","heroicons_solid:calendar"),n(2),D(i.card.dueDate?23:-1),n(),D(i.card.dueDate?-1:24),n(),d("subscriptSizing","dynamic"),n(),d("formControlName","dueDate")("matDatepicker",r),n(6),d("color","primary"),n(8),d("svgIcon","heroicons_solid:magnifying-glass"),n(),d("maxLength",50),n(2),E(i.filteredLabels)}},dependencies:[P,$,U,V,M,re,ee,X,Y,Z,oe,te,ie,Qe,Ge,Pe,tt,et,ye,we,O,dt,ot,nt,lt,st,at,rt,it,ge],encapsulation:2,changeDetection:0})}}return o})();var xt=(()=>{class o{constructor(e,t,i){this._activatedRoute=e,this._matDialog=t,this._router=i}ngOnInit(){this._matDialog.open(gt,{autoFocus:!1}).afterClosed().subscribe(()=>{this._router.navigate(["./../.."],{relativeTo:this._activatedRoute})})}static{this.\u0275fac=function(t){return new(t||o)(_(Oe),_(Ue),_(ce))}}static{this.\u0275cmp=y({type:o,selectors:[["scrumboard-card"]],decls:1,vars:0,template:function(t,i){t&1&&m(0,`SCRUMBOARD -> BOARDS -> LIST -> CARD
`)},encapsulation:2,changeDetection:0})}}return o})();var Jt=(o,l)=>{let e=W(T),t=W(ce);return e.getBoard(o.paramMap.get("boardId")).pipe(Ie(i=>{console.error(i);let r=l.url.split("/").slice(0,-1).join("/");return t.navigateByUrl(r),le(i)}))},Wt=(o,l)=>{let e=W(T),t=W(ce);return e.getCard(o.paramMap.get("cardId")).pipe(Ie(i=>{console.error(i);let r=l.url.split("/").slice(0,-1).join("/");return t.navigateByUrl(r),le(i)}))},Cr=[{path:"",component:vt,resolve:{boards:()=>W(T).getBoards()}},{path:":boardId",component:_t,resolve:{board:Jt},children:[{path:"card/:cardId",component:xt,resolve:{card:Wt}}]}];export{Cr as default};
